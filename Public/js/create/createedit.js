var mainmodele="<!DOCTYPE html>";
mainmodele+="\r\n<html>";
mainmodele+="\r\n<head>";
mainmodele+="\r\n<title>_memu_编辑</title>";
mainmodele+="\r\n<bnc ctrname=\"gxsub\" id=\"_proid__edit{@isnew@}\" reg=true mod=\"_memu_\" plugin=\"mxdetail,mxtoolbar,mxcombox,mxselect,mxdisplay,mxcheckbox\"></bnc>";
mainmodele+="\r\n</head>";
mainmodele+="\r\n<body class=\"gray-bg\">";
mainmodele+="\r\n	<div class=\"animated fadeInRight\" rowsplit=\"100%\">";
mainmodele+="\r\n		<div class=\"ibox\">";		
mainmodele+="\r\n			<div class=\"ibox-title\">";
mainmodele+="\r\n				<div  class=\"col-sm-4\">";
mainmodele+="\r\n					<bnc ctrname=\"mxtoolbar\" id=\"mytoolbar\" items=\"[{text:'新建',right:'_right__add',class:'btn-primary btn-sm',img:'fa-plus',click:'add()',title:'新建_memu_'},{text:'保存',right:'_right__save',class:'btn-primary btn-sm',img:'fa-save',click:'save()',title:'修改_memu_信息'},{text:'置空',right:0,class:'btn-primary btn-sm',click:'reset()',img:'fa-reply',title:'清除表单信息'}]\"></bnc>";
mainmodele+="\r\n				</div>";
mainmodele+="\r\n			</div>";
mainmodele+="\r\n			<div class=\"ibox-content form-horizontal\">";										
mainmodele+="\r\n				<div class=\"row form-group\">";
mainmodele+="\r\n					<div class=\"col-md-6\">";	
mainmodele+="\r\n						<label class=\"col-sm-2 control-label\">备注</label>";
mainmodele+="\r\n						<div class=\"col-sm-10\">";
mainmodele+="\r\n							<TEXTAREA class=\"form-control\" dataFld=\"remarks\" id=\"remarks\" datatype=\"varchar(2000)\" valuetype=\"value\" name=\"remarks\" rows=\"3\" dataname=\"备注\" ofdisplay=\"myshow\"></TEXTAREA>";			
mainmodele+="\r\n						</div>";
mainmodele+="\r\n					</div>";
mainmodele+="\r\n				</div>";
mainmodele+="\r\n			</div>";
mainmodele+="\r\n		</div>";	
mainmodele+="\r\n	</div>";		
mainmodele+="\r\n<bnc ctrname=\"mxdisplay\" id=\"myshow\"";
mainmodele+="\r\nfirstsql=\"code:select id,remarks from _tbname_ as _alia_ where id=[@id@]\" firstparam=\"id=_id_\" tbname=\"_tbname_\" buttadd=\"\" buttedit=\"\" buttdel=\"\" buttsave=\"\" buttcancel=\"\" fieldset=\"document\" log=\"true\" logextra=\"\" transaction=\"main\"></bnc>";
mainmodele+="\r\n<script>";
mainmodele+="\r\nvar ID=0;";
mainmodele+="\r\nvar parent=gxsub.top.subMapping._proid_;";
mainmodele+="\r\nvar curstates=0;";
mainmodele+="\r\nfunction show(id){//初始化";
mainmodele+="\r\n	if(id==0){";
mainmodele+="\r\n		if(ID>0){";
mainmodele+="\r\n			reset();";
mainmodele+="\r\n		}";
mainmodele+="\r\n		checkUpload();";
mainmodele+="\r\n	}else{";
mainmodele+="\r\n		ID=id;";
mainmodele+="\r\n		myshow.display(ID).then(function(ret){";
mainmodele+="\r\n			curstates=myshow.data.states.value;";
mainmodele+="\r\n			checkUpload();";
mainmodele+="\r\n		});";
mainmodele+="\r\n	}";
mainmodele+="\r\n}";
mainmodele+="\r\nfunction reset(){";
mainmodele+="\r\n	ID=0;";
mainmodele+="\r\n	myshow.clear();";
mainmodele+="\r\n}";
mainmodele+="\r\nfunction checkUpload(){";
mainmodele+="\r\n	if(\"{@isnew@}\"==\"1\"){";
mainmodele+="\r\n		mytoolbar.hide(\"保存\");";
mainmodele+="\r\n		mytoolbar.show(\"新建,置空\");";
mainmodele+="\r\n	}";
mainmodele+="\r\n	else if(curstates!=20){";
mainmodele+="\r\n		mytoolbar.hide(\"新建,置空\");";
mainmodele+="\r\n		mytoolbar.show(\"保存\");";
mainmodele+="\r\n	}else{";
mainmodele+="\r\n		mytoolbar.hide();";	
mainmodele+="\r\n	}";
mainmodele+="\r\n}";
mainmodele+="\r\nfunction checkinuput(id){";
mainmodele+="\r\n	var res=\"\";";
mainmodele+="\r\n	var titleval=$(\"#cname\").val();";
mainmodele+="\r\n	titleval=titleval.replace(/[\s']/g,\"\");";
mainmodele+="\r\n	gxsub.toast_close();";
mainmodele+="\r\n	if(!myshow.validator()){";
mainmodele+="\r\n		return false;";
mainmodele+="\r\n	}";
mainmodele+="\r\n	res=gxsub.bgsend(\"_proid__edit_ck.ben\",\"curid=\"+gxsub.base64_encode(\"\"+id)+\"&mytitle=\"+gxsub.base64_encode(\"\"+titleval));";
mainmodele+="\r\n	if(res<0){";
mainmodele+="\r\n		gxsub.toast({title:\"错误\",text:\"系统错误\",type:\"error\"});";
mainmodele+="\r\n		return false;";
mainmodele+="\r\n	}";
mainmodele+="\r\n	res=JSON.parse(res);";
mainmodele+="\r\n	if(res.msg!=\"\"){";
mainmodele+="\r\n		gxsub.toast({title:(id==0?\"新建\":\"保存\")+\"失败\",text:res.msg,type:\"error\"});";
mainmodele+="\r\n		if(res.fld!=\"\"){";
mainmodele+="\r\n			myshow.focus(res.fld);";
mainmodele+="\r\n		}";
mainmodele+="\r\n		return false;";
mainmodele+="\r\n	}";
mainmodele+="\r\n	return true;";
mainmodele+="\r\n}";
mainmodele+="\r\nfunction add(){//增加";
mainmodele+="\r\n	if(!checkinuput(0)){";
mainmodele+="\r\n		return;";
mainmodele+="\r\n	}";
mainmodele+="\r\n	mytoolbar.hide();";
mainmodele+="\r\n	myshow.add().then(function(newid){";
mainmodele+="\r\n		mytoolbar.show(\"新建,置空\");";
mainmodele+="\r\n		if(newid==-1){";
mainmodele+="\r\n			gxsub.msgbox({title:\"数据库连接错误！\",type:\"error\"});";
mainmodele+="\r\n			return;";
mainmodele+="\r\n		}";
mainmodele+="\r\n		if (newid>0){";
mainmodele+="\r\n			ID=newid;";
mainmodele+="\r\n			gxsub.sendmsg(\"refreshall\",\"_proid_\");";
mainmodele+="\r\n		}";
mainmodele+="\r\n	});	";	
mainmodele+="\r\n}";
mainmodele+="\r\nfunction save(){//保存修改信息";
mainmodele+="\r\n	if(!checkinuput(ID)){";
mainmodele+="\r\n		return;";
mainmodele+="\r\n	}";
mainmodele+="\r\n	myshow.update().then(function(res){";
mainmodele+="\r\n		if(res==-1){";
mainmodele+="\r\n			parent.gxsub.msgbox({title:\"数据库连接错误！\",type:\"error\"});";
mainmodele+="\r\n			return;";
mainmodele+="\r\n		}";
mainmodele+="\r\n		if(res==0){";
mainmodele+="\r\n			gxsub.toast({title:\"保存提示\",text:\"无数据修改\",type:\"info\"});";
mainmodele+="\r\n			return;";
mainmodele+="\r\n		}else if (res>0){";
mainmodele+="\r\n			gxsub.sendmsg(\"refresh\",\"_proid_\",[ID]);";
mainmodele+="\r\n			gxsub.sendmsg(\"refreshpage,\"+$(\"#cname\").val(),\"_proid__page\");";
mainmodele+="\r\n		}";
mainmodele+="\r\n	});";
mainmodele+="\r\n}";
mainmodele+="\r\n</script>";
mainmodele+="\r\n</body>";
mainmodele+="\r\n</html>";
function createedit(){
	var oldvalue=["_proid_","_right_","_memu_","_tbname_","_alia_"];
	var inputarr=$("input");
	for (var i=0;i<inputarr.length;i++){
		oldvalue[i]="/"+oldvalue[i]+"/g";
		mainmodele=mainmodele.replace(eval(oldvalue[i]),inputarr[i].value);
	}
	
	$("#newtext").val(mainmodele);
}